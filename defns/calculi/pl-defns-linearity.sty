\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{pl-defns-linearity}[\texttt{pl\-defns\-linearity} Definitions for linear calculus]

\RequirePackage{xparse}
\IfClassLoadedTF{acmart}{}{
    \RequirePackage{amssymb}
}
\RequirePackage{stmaryrd}

\RequirePackage[abt]{pl-syntax}

\makeatletter

%% Arguments: Name / Type
\NewDocumentCommand{\unaryTyOp@Abt}{m m}{\A@bt{#1}(#2)}
\NewDocumentCommand{\unaryTyOp@Cst}{m m}{{#1}\,{#2}}
\NewDocumentCommand{\unaryTy}{m m m m}{\IfBooleanTF{#1}{\unaryTyOp@Cst{#3}{#4}}{\unaryTyOp@Abt{#2}{#4}}}

\NewDocumentCommand{\prefixBinTyOp@Abt}{m m m}{\A@bt{#1}({#2};{#3})}
\NewDocumentCommand{\prefixBinTyOp@Cst}{m m m}{{#1}\,\{{#2}, {#3}\}}
\NewDocumentCommand{\prefixBinTy}{m m m m m}{\IfBooleanTF{#1}{\prefixBinTyOp@Cst{#3}{#4}{#5}}{\prefixBinTyOp@Abt{#2}{#4}{#5}}}

\NewDocumentCommand{\infixBinTyOp@Abt}{m m m}{\A@bt{#1}({#2};{#3})}
\NewDocumentCommand{\infixBinTyOp@Cst}{m m m}{{#2}{#1}{#3}}
\NewDocumentCommand{\infixBinTy}{m m m m m}{\IfBooleanTF{#1}{\infixBinTyOp@Cst{#3}{#4}{#5}}{\infixBinTyOp@Abt{#2}{#4}{#5}}}

%% Defining the operators
\NewDocumentCommand{\optensor}{}{\otimes}
\NewDocumentCommand{\oplolli}{}{\multimap}
\NewDocumentCommand{\opwith}{}{\mathop{\&}}
\NewDocumentCommand{\opplus}{}{+}
\NewDocumentCommand{\optimes}{}{\times}
\NewDocumentCommand{\optop}{}{\top}
\NewDocumentCommand{\opbot}{}{\bot}


\NewDocumentCommand{\opPi}{d<>}{\pi_{#1}}
\NewDocumentCommand{\opIn}{d<>}{i_{#1}}

\NewDocumentCommand{\opPiOne}{}{\opPi<1>}
\NewDocumentCommand{\opPiTwo}{}{\opPi<2>}
\NewDocumentCommand{\opInOne}{}{\opIn<1>}
\NewDocumentCommand{\opInTwo}{}{\opIn<2>}

\NewDocumentCommand{\larrTy}{s m m}{\infixBinTy{#1}{\Opn{larr}}{\oplolli}{#2}{#3}}
\NewDocumentCommand{\withTy}{s m m}{\infixBinTy{#1}{\Opn{with}}{\opwith}{#2}{#3}}

\NewDocumentCommand{\optionally@Arg}{m m}{\IfNoValueTF{#2}{#1}{\A@bt{#1}(#2)}}


\NewDocumentCommand{\piEx}{s d<> m}{\optionally@Arg{\opPi<#2>}{#3}}
\DeclareDocumentCommand{\inEx}{s d<> m}{\optionally@Arg{\opIn<#2>}{#3}}

\NewDocumentCommand{\piOneEx}{s m}{\optionally@Arg{\opPiOne}{#2}}
\NewDocumentCommand{\piTwoEx}{s m}{\optionally@Arg{\opPiTwo}{#2}}

\NewDocumentCommand{\inOneEx}{s m}{\optionally@Arg{\opInOne}{#2}}
\NewDocumentCommand{\inTwoEx}{s m}{\optionally@Arg{\opInTwo}{#2}}

\makeatother