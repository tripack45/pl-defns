\makeatletter

%% Session types
\DeclareDocumentCommand{\STypeSort}{}{\sort{Ses Typ}}

\DeclareDocumentCommand{\unitstyabt}{}{\Opn{unit}}
\DeclareDocumentCommand{\unitstycst}{}{\ensuremath{\mathbf{1}}}
\DeclareDocumentCommand{\unitSty}{s}{\IfBooleanTF{#1}{\unitstycst}{\unitstyabt}}

\DeclareDocumentCommand{\larrstyabt}{ m m }{\Abt{\Opn{larr}}\parens{#1\sep #2}}
\DeclareDocumentCommand{\larrstycst}{ m m }{{#1}\mathrel{\multimap}{#2}}
\DeclareDocumentCommand{\larrSty}{s m m}{\IfBooleanTF{#1}{\larrstycst{#2}{#3}}{\larrstyabt{#2}{#3}}}

\DeclareDocumentCommand{\tensorstyabt}{ m m }{\Abt{\Opn{tensor}}\parens{#1\sep #2}}
\DeclareDocumentCommand{\tensorstycst}{ m m }{{#1}\mathrel{\otimes}{#2}}
\DeclareDocumentCommand{\tensorSty}{s m m}{\IfBooleanTF{#1}{\tensorstycst{#2}{#3}}{\tensorstyabt{#2}{#3}}}

\DeclareDocumentCommand{\ichoicestyabt}{ m m }{\Abt{\Opn{ichoice}\cdsqbracks{\overline{#1}}}\parens{\overline{#2}}}
\DeclareDocumentCommand{\ichoicestycst}{ m m }{\Abt{\oplus}\parens{\overline{#1 \hookrightarrow #2}}}
\DeclareDocumentCommand{\ichoiceSty}{s m m}{\IfBooleanTF{#1}{\ichoicestycst{#2}{#3}}{\ichoicestyabt{#2}{#3}}}

\DeclareDocumentCommand{\withstyabt}{ m m }{\Abt{\Opn{with}\cdsqbracks{\overline{#1}}}\parens{\overline{#2}}}
\DeclareDocumentCommand{\withstycst}{ m m }{\Abt{\&}\parens{\overline{#1 \hookrightarrow #2}}}
\DeclareDocumentCommand{\withSty}{s m m}{\IfBooleanTF{#1}{\withstycst{#2}{#3}}{\withstyabt{#2}{#3}}}

\DeclareDocumentCommand{\bsumstyabt}{ m m }{\sumTy{#1}{#2}}
\DeclareDocumentCommand{\bsumstycst}{ m m }{{#1}\mathrel{\oplus}{#2}}
\DeclareDocumentCommand{\bsumSty}{s m m}{\IfBooleanTF{#1}{\bsumstycst{#2}{#3}}{\bsumstyabt{#2}{#3}}}

\DeclareDocumentCommand{\bwithstyabt}{ m m }{\Abt{\Opn{with}}\parens{#1\sep #2}}
\DeclareDocumentCommand{\bwithstycst}{ m m }{{#1}\mathrel{\&}{#2}}
\DeclareDocumentCommand{\bwithSty}{s m m}{\IfBooleanTF{#1}{\bwithstycst{#2}{#3}}{\bwithstyabt{#2}{#3}}}
%% Channels 
\DeclareDocumentCommand{\ChanSort}{}{\sort{Chan}}

%% Process terms
\DeclareDocumentCommand{\ProcSort}{}{\sort{Proc}}

% Forward
\DeclareDocumentCommand{\fwdabt}{ m }{\Abt{\Opn{fwd}}\parens{#1}}
\DeclareDocumentCommand{\fwdcst}{ m }{\Abt{\Opn{fwd}}\parens{#1}}
\DeclareDocumentCommand{\fwd}{s m}{\IfBooleanTF{#1}{\fwdcst{#2}}{\fwdabt{#2}}}
% Provider of unit
\DeclareDocumentCommand{\closeabt}{}{\Opn{close}}
\DeclareDocumentCommand{\closecst}{}{\unitEx*}
\DeclareDocumentCommand{\close}{s}{\IfBooleanTF{#1}{\closecst}{\closeabt}}
% Client of unit
\DeclareDocumentCommand{\waitabt}{ m m }{\Abt{\Opn{wait}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\waitcst}{ m m }{\Abt{\Opn{wait}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\wait}{s m m}{\IfBooleanTF{#1}{\waitcst{#2}{#3}}{\waitabt{#2}{#3}}}
% Provider of loli
\DeclareDocumentCommand{\larrrcvabt}{ m m m }{\Abt{\Opn{rcv}\cdsqbracks{#1}}\parens{\Abs(#2){#3}}}
\DeclareDocumentCommand{\larrrcvcst}{ m m m }{\Abt{\lambda_{#1}}\parens{\Abs(#2){#3}}}
\DeclareDocumentCommand{\larrRcv}{s m m m}{\IfBooleanTF{#1}{\larrrcvcst{#2}{#3}{#4}}{\larrrcvabt{#2}{#3}{#4}}}
% Client of loli
\DeclareDocumentCommand{\larrsndabt}{ m m m m }{\Abt{\Opn{snd}}\parens{#1\sep #2\sep \Abs(#3){#4}}}
\DeclareDocumentCommand{\larrsndcst}{ m m m m }{#1\parens{#2}\sep \Abs(#3){#4}}
\DeclareDocumentCommand{\larrSnd}{s m m m m}{\IfBooleanTF{#1}{\larrsndcst{#2}{#3}{#4}{#5}}{\larrsndabt{#2}{#3}{#4}{#5}}}
% Provider of tensor
\DeclareDocumentCommand{\tensorsndabt}{ m m }{\Abt{\Opn{pair}}\parens{#1\sep #2}}
\DeclareDocumentCommand{\tensorsndcst}{ m m }{{#1}\mathrel{\otimes}{#2}}
\DeclareDocumentCommand{\tensorSnd}{s m m}{\IfBooleanTF{#1}{\tensorsndcst{#2}{#3}}{\tensorsndabt{#2}{#3}}}
% Client of tensor
\DeclareDocumentCommand{\tensorrcvabt}{ m m m m }{\Abt{\Opn{split}}\parens{#1\sep \Abs(#2){\Abs(#3){#4}}}}
\DeclareDocumentCommand{\tensorrcvcst}{ m m m m }{\Opn{split}\,{#1}\sep \Abs(#2){\Abs(#3){#4}}}
\DeclareDocumentCommand{\tensorRcv}{s m m m m}{\IfBooleanTF{#1}{\tensorrcvcst{#2}{#3}{#4}{#5}}{\tensorrcvabt{#2}{#3}{#4}{#5}}}
% Provider of internal choice
\DeclareDocumentCommand{\inabt}{ m m m m }{\Abt{\Opn{in}\cdsqbracks{\overline{#1}\sep \overline{#2}}\cdsqbracks{#3}}\parens{#4}}
\DeclareDocumentCommand{\incst}{ m m m m }{{#3}\cdot{#4}}
\DeclareDocumentCommand{\inChoice}{s m m m m}{\IfBooleanTF{#1}{\incst{#2}{#3}{#4}{#5}}{\inabt{#2}{#3}{#4}{#5}}}
% Client of internal choice
\DeclareDocumentCommand{\caseabt}{ m m m m }{\Abt{\Opn{case}\cdsqbracks{\overline{#2}}}\parens{#1\sep \overline{\Abs(#3){#4}}}}
\DeclareDocumentCommand{\casecst}{ m m m m }{\Opn{case}\parens{#1}\,\cdbraces{\overline{{#2} \cdot{#3} \casebrcst #4}}}
\DeclareDocumentCommand{\case}{s m m m m}{\IfBooleanTF{#1}{\casecst{#2}{#3}{#4}{#5}}{\caseabt{#2}{#3}{#4}{#5}}}
% Provider of external choice
\DeclareDocumentCommand{\offerabt}{ m m }{\Abt{\Opn{offer}\cdsqbracks{\overline{#1}}}\parens{\overline{#2}}}
\DeclareDocumentCommand{\offercst}{ m m }{\Opn{offer}\,\cdbraces{\overline{{#1}\casebrcst{#2}}}}
\DeclareDocumentCommand{\offer}{s m m}{\IfBooleanTF{#1}{\offercst{#2}{#3}}{\offerabt{#2}{#3}}}
% Client of external choice
\DeclareDocumentCommand{\selectcst}{ m m m m }{{#1}\cdot{#2}\sep \Abs(#3){#4}}
\DeclareDocumentCommand{\selectabt}{ m m m m }{\Abt{\Opn{select}\cdsqbracks{#2}}\parens{#1\sep \Abs(#3){#4}}}
\DeclareDocumentCommand{\select}{s m m m m}{\IfBooleanTF{#1}{\selectcst{#2}{#3}{#4}{#5}}{\selectabt{#2}{#3}{#4}{#5}}}
% Spawn proc 
\DeclareDocumentCommand{\spawnprocabt}{ m m m m }{\Abt{\Opn{spawn}\cdsqbracks{#2}}\parens{#1\sep \Abs(#3){#4}}}
\DeclareDocumentCommand{\spawnproccst}{ m m m m }{\Abt{\Opn{spawn}}\parens{#1\sep \Abs(#3){#4}}}
\DeclareDocumentCommand{\spawn}{s m m m m}{\IfBooleanTF{#1}{\spawnproccst{#2}{#3}{#4}{#5}}{\spawnprocabt{#2}{#3}{#4}{#5}}}

%% binary version of the choices 
\DeclareDocumentCommand{\inlabt}{ m m m m m }{\Abt{\Opn{inl}\cdsqbracks{#1\sep #3\sep #4}}\parens{\Abs(#2){#5}}}
\DeclareDocumentCommand{\inrabt}{ m m m m m }{\Abt{\Opn{inr}\cdsqbracks{#1\sep #3\sep #4}}\parens{\Abs(#2){#5}}}
\DeclareDocumentCommand{\inlcst}{ m m m m m }{\Opn{l}^{\isOf{#2}{#1}}\cdot{#5}}
\DeclareDocumentCommand{\inrcst}{ m m m m m }{\Opn{r}^{\isOf{#2}{#1}}\cdot{#5}}
\DeclareDocumentCommand{\inL}{ s m m m m m }{\IfBooleanTF{#1}{\inlcst{#2}{#3}{#4}{#5}{#6}}{\inlabt{#2}{#3}{#4}{#5}{#6}}}
\DeclareDocumentCommand{\inR}{ s m m m m m }{\IfBooleanTF{#1}{\inrcst{#2}{#3}{#4}{#5}{#6}}{\inrabt{#2}{#3}{#4}{#5}{#6}}}
% Client of internal choice
\DeclareDocumentCommand{\bcaseabt}{ m m m m }{\Abt{\Opn{case}}\parens{#1\sep #2\sep #3\sep #4}}
\DeclareDocumentCommand{\bcasecst}{ m m m m }{\Opn{case}^{#1}\,{#2}\,\cdbraces{\Opn{l} \casebrcst{#3} \mid \Opn{r} \casebrcst{#4}}}
\DeclareDocumentCommand{\bCase}{s m m m m}{\IfBooleanTF{#1}{\bcasecst{#2}{#3}{#4}{#5}}{\bcaseabt{#2}{#3}{#4}{#5}}}
% Provider of external choice
\DeclareDocumentCommand{\bofferabt}{ m m m m }{\Abt{\Opn{offer}\cdsqbracks{#1}}\parens{\Abs(#2){#3}\sep \Abs(#2){#4}}}
\DeclareDocumentCommand{\boffercst}{ m m m m }{\Opn{offer}^{\isOf{#2}{#1}}\,\cdbraces{\Opn{l}\casebrcst{#3} \mid \Opn{r}\casebrcst{#4}}}
\DeclareDocumentCommand{\bOffer}{s m m m m}{\IfBooleanTF{#1}{\boffercst{#2}{#3}{#4}{#5}}{\bofferabt{#2}{#3}{#4}{#5}}}
% Client of external choice
\DeclareDocumentCommand{\bselectlabt}{ m m m }{\Abt{\Opn{prl}}\parens{#1\sep #2\sep {#3}}}
\DeclareDocumentCommand{\bselectlcst}{ m m m }{{#1}\cdsqbracks{#2}\cdot\Opn{l}\sep {#3}}
\DeclareDocumentCommand{\bselectrabt}{ m m m }{\Abt{\Opn{prr}}\parens{#1\sep #2\sep {#3}}}
\DeclareDocumentCommand{\bselectrcst}{ m m m }{{#1}\cdsqbracks{#2}\cdot\Opn{r}\sep {#3}}
\DeclareDocumentCommand{\bSelectL}{s m m m}{\IfBooleanTF{#1}{\bselectlcst{#2}{#3}{#4}}{\bselectlabt{#2}{#3}{#4}}}
\DeclareDocumentCommand{\bSelectR}{s m m m}{\IfBooleanTF{#1}{\bselectrcst{#2}{#3}{#4}}{\bselectrabt{#2}{#3}{#4}}}

%% Two functional ones
\DeclareDocumentCommand{\bangstyabt}{ m m }{{\,!\,}_{#1}\cdot\,{#2}}
\DeclareDocumentCommand{\bangstycst}{ m m }{{\,!\,}_{#1}\cdot\,{#2}}
\DeclareDocumentCommand{\querystyabt}{ m m }{{\,?\,}_{#1}\cdot\,{#2}}
\DeclareDocumentCommand{\querystycst}{ m m }{{\,?\,}_{#1}\cdot\,{#2}}
\DeclareDocumentCommand{\bangSty}{s m m}{\IfBooleanTF{#1}{\bangstycst{#2}{#3}}{\bangstyabt{#2}{#3}}}
\DeclareDocumentCommand{\querySty}{s m m}{\IfBooleanTF{#1}{\querystycst{#2}{#3}}{\querystyabt{#2}{#3}}}

%% Configurations
\DeclareDocumentCommand{\ConfSort}{}{\Sort{Conf}}

\DeclareDocumentCommand{\runprocabt}{ m m m }{\Abt{\Opn{run}}{\Abs(#1){({#2}\sep {#3})}}}
\DeclareDocumentCommand{\runproccst}{ m m m }{\Abs(\nu_{#1}){{#2}\mathbin{\triangleleft}{#3}}}
\DeclareDocumentCommand{\runProc}{s m m m}{\IfBooleanTF{#1}{\runproccst{#2}{#3}{#4}}{\runprocabt{#2}{#3}{#4}}}

\DeclareDocumentCommand{\tunnelabt}{ m }{\Abt{\Opn{tunnel}}\parens{#1}}
\DeclareDocumentCommand{\tunnelcst}{ m }{{\bullet_{#1}}}
\DeclareDocumentCommand{\tunnel}{s m}{\IfBooleanTF{#1}{\tunnelcst{#2}}{\tunnelabt{#2}}}

%% Statics
\DeclareDocumentCommand{\isOfChan}{ m m }{\isOf{#1}{#2}}
\DeclareDocumentCommand{\isOfProc}{ m m }{\isOfKd{#1}{#2}}
\DeclareDocumentCommand{\isOfProcSILL}{ m m }{\isOfKd{#1}{#2}}
\DeclareDocumentCommand{\isOfConf}{ m m }{\retsTp{#1}{#2}}

\DeclareDocumentCommand{\EmptySig}{}{\varepsilon}
\DeclareDocumentCommand{\EmptySubconf}{}{\varepsilon}
\DeclareDocumentCommand{\EmptyCtx}{}{\cdot}

\DeclareDocumentCommand{\TSigma}{}{\tilde{\Sigma}}

%% Dynamics
\DeclareDocumentCommand{\runprocframed}{ m m m }{\Abs(\tilde{\nu}_{#1}){{#2}\mathbin{\triangleleft}{#3}}}

\DeclareDocumentCommand{\actiontauabt}{}{\Opn{none}}
\DeclareDocumentCommand{\actiontaucst}{}{\varepsilon}
\DeclareDocumentCommand{\actionTau}{s}{\IfBooleanTF{#1}{\actiontaucst}{\actiontauabt}}
\DeclareDocumentCommand{\actionlqabt}{ m m }{\Abt{\Opn{actionLQ}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\actionlqcst}{ m m }{{#2}\mathbin{?}{#1}}
\DeclareDocumentCommand{\actionLq}{s m m}{\IfBooleanTF{#1}{\actionlqcst{#2}{#3}}{\actionlqabt{#2}{#3}}}
\DeclareDocumentCommand{\actionrqabt}{ m m }{\Abt{\Opn{actionRQ}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\actionrqcst}{ m m }{{#1}\mathbin{?}{#2}}
\DeclareDocumentCommand{\actionRq}{s m m}{\IfBooleanTF{#1}{\actionrqcst{#2}{#3}}{\actionrqabt{#2}{#3}}}
\DeclareDocumentCommand{\actionleabt}{ m m }{\Abt{\Opn{actionLE}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\actionlecst}{ m m }{{#2}\mathbin{!}{#1}}
\DeclareDocumentCommand{\actionLe}{s m m}{\IfBooleanTF{#1}{\actionlecst{#2}{#3}}{\actionleabt{#2}{#3}}}
\DeclareDocumentCommand{\actionreabt}{ m m }{\Abt{\Opn{actionRE}}\parens{{#1}\sep {#2}}}
\DeclareDocumentCommand{\actionrecst}{ m m }{{#1}\mathbin{!}{#2}}
\DeclareDocumentCommand{\actionRe}{s m m}{\IfBooleanTF{#1}{\actionrecst{#2}{#3}}{\actionreabt{#2}{#3}}}

%% Payload
\DeclareDocumentCommand{\pldcloseabt}{}{\Opn{close}}
\DeclareDocumentCommand{\pldclosecst}{}{\Opn{close}}
\DeclareDocumentCommand{\pldClose}{s}{\IfBooleanTF{#1}{\pldclosecst}{\pldcloseabt}}
\DeclareDocumentCommand{\pldlblabt}{ m }{\Abt{\Opn{label}}{#1}}
\DeclareDocumentCommand{\pldlblcst}{ m }{{#1}}
\DeclareDocumentCommand{\pldLbl}{s m}{\IfBooleanTF{#1}{\pldlblcst{#2}}{\pldlblabt{#2}}}
\DeclareDocumentCommand{\pldconfabt}{ m }{\Abt{\Opn{conf}}{#1}}
\DeclareDocumentCommand{\pldconfcst}{ m }{{#1}}
\DeclareDocumentCommand{\pldConf}{s m}{\IfBooleanTF{#1}{\pldconfcst{#2}}{\pldconfabt{#2}}}

% \DeclareDocumentCommand{\leftquery}{ m }{{#1}\Opn{?}}
% \DeclareDocumentCommand{\rightquery}{ m }{\Opn{?}{#1}}
% \DeclareDocumentCommand{\leftemit}{ m }{{#1}\Opn{!}}
% \DeclareDocumentCommand{\rightemit}{ m }{\Opn{!}{#1}}

%% Tunneled configuration
\DeclareDocumentCommand{\tconfabt}{ m m }{{#1}\mathbin{||}{#2}}
\DeclareDocumentCommand{\tconfcst}{ m m }{{#1}\mathbin{||}{#2}}
\DeclareDocumentCommand{\tConf}{s m m}{\IfBooleanTF{#1}{\tconfcst{#2}{#3}}{\tconfabt{#2}{#3}}}

\makeatother
